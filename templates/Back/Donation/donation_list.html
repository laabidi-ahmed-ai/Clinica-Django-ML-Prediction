{% load static %}
<!DOCTYPE html>
<html dir="ltr" lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Clinica+ ‚Ä¢ Donations</title>
  <link rel="icon" type="image/png" sizes="16x16" href="{% static 'Back/src/assets/images/favicon.png' %}">
  <link href="{% static 'Back/src/dist/css/style.min.css' %}" rel="stylesheet">
  
  <style>
    /* Variables */
    :root {
      --primary-blue: #4A90E2;
      --success-green: #28a745;
      --danger-red: #dc3545;
      --warning-orange: #FF8C00;
      --purple: #667eea;
    }
    
    body {
      background-color: #f8f9fa;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }
    
    /* Page header */
    .page-header {
      background: white;
      padding: 24px 30px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
      margin-bottom: 24px;
    }
    
    .page-title {
      font-size: 1.75rem;
      font-weight: 600;
      color: #1a1a1a;
      margin: 0;
    }
    
    /* Card */
    .card {
      border: none;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
      background: white;
    }
    
    .card-body {
      padding: 0;
    }
    
    /* Table */
    .table {
      margin-bottom: 0;
      font-size: 0.875rem;
    }
    
    .table thead th {
      background-color: #f8f9fa;
      border-bottom: 2px solid #e9ecef;
      color: #495057;
      font-weight: bold;
      text-transform: uppercase;
      font-size: 0.75rem;
      letter-spacing: 0.5px;
      padding: 16px 20px;
      border-top: none;
       white-space: nowrap;  /* ‚Üê Emp√™che le retour √† la ligne */
  min-width: fit-content;  /* ‚Üê Ajuste la largeur */
    }
    
    .table tbody tr {
      transition: all 0.2s ease;
      cursor: pointer;
      border-bottom: 1px solid #f0f0f0;
       white-space: nowrap;  /* ‚Üê Emp√™che le retour √† la ligne */
  min-width: fit-content;  /* ‚Üê Ajuste la largeur */
    }
    
    .table tbody tr:hover {
      background-color: #f8f9fa;
      transform: scale(1.005);
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }
    
    .table tbody td {
      padding: 16px 20px;
      vertical-align: middle;
      color: #495057;
    }
    
    /* Badges */
    .badge-type {
      padding: 6px 14px;
      border-radius: 20px;
      font-weight: 600;
      font-size: 0.8rem;
      display: inline-block;
    }
    
    .badge-argent {
      background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      color: white;
      box-shadow: 0 2px 6px rgba(40, 167, 69, 0.3);
    }
    
    .badge-volontariat {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      box-shadow: 0 2px 6px rgba(102, 126, 234, 0.3);
    }
    
    .badge-status {
      padding: 6px 14px;
      border-radius: 20px;
      font-weight: 600;
      font-size: 0.8rem;
       white-space: nowrap;  /* ‚Üê Emp√™che le retour √† la ligne */
  min-width: fit-content;  /* ‚Üê Ajuste la largeur au contenu */
    }
    
    .badge-en-attente {
      background: linear-gradient(135deg, #FF8C00 0%, #FF6347 100%);
      color: white;
    }
    
    .badge-valide {
      background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      color: white;
    }
    
    .badge-echec {
      background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
      color: white;
    }
    
    /* Action buttons - Style CARR√â avec ic√¥ne + texte */
.btn-action-group {
  display: flex;
  gap: 8px;
  align-items: center;
  justify-content: center;
}

/* Style de base - Carr√©s verticaux */
.btn-detail,

.btn-danger-custom {
  border: none;
  color: white;
  height: 55px;
  padding: 5px 13px;
      border-radius: 6px;
      font-weight: 500;
      font-size: 0.8rem;
  transition: all 0.2s ease;
  text-decoration: none;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 6px;
}

/* Detail button - Cyan */
.btn-detail {
  background: #17a2b8 !important;
  box-shadow: 0 3px 8px rgba(23, 162, 184, 0.3);
}

.btn-detail:hover {
  background: #138496 !important;
  color: white !important;
  transform: translateY(-3px);
  box-shadow: 0 5px 15px rgba(23, 162, 184, 0.4);
  text-decoration: none;
}

.btn-detail:focus,
.btn-detail:active {
  background: #138496 !important;
  color: white !important;
  outline: none;
}

/* Edit button - Green */


/* Delete button - Red */
.btn-danger-custom {

  background: var(--danger-red);
      border: none;
      color: white;
      padding: 5px 13px;
      border-radius: 6px;
      font-weight: 500;
      font-size: 0.8rem;
      transition: all 0.2s ease;
      box-shadow: 0 2px 6px rgba(220, 53, 69, 0.25);
}

.btn-danger-custom:hover {
  background: #c82333 !important;
  color: white !important;
  transform: translateY(-3px);
  box-shadow: 0 5px 15px rgba(220, 53, 69, 0.4);
}

/* Icons - Plus grands et centr√©s */
.btn-detail i,
.btn-edit i,
.btn-danger-custom i {
  width: 20px !important;
      height: 20px !important;
      margin-bottom: 2px;
}


    /* Stats cards */
    .stat-card {
      background: white;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
      transition: all 0.3s ease;
    }
    
    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.12);
    }
    
    .stat-card .stat-icon {
      width: 50px;
      height: 50px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 12px;
    }
    
    .stat-card .stat-value {
      font-size: 2rem;
      font-weight: 700;
      color: #1a1a1a;
      margin: 0;
    }
    
    .stat-card .stat-label {
      color: #868e96;
      font-size: 0.875rem;
      margin: 0;
    }
    
    /* Modal */
    .modal-content {
      border-radius: 16px;
      border: none;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    
    .modal-header {
      border-radius: 16px 16px 0 0;
      padding: 24px 30px;
      background: linear-gradient(135deg, #4A90E2 0%, #357ABD 100%);
      color: white;
      border-bottom: none;
    }
    
    .modal-header.delete-header {
      background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
    }
    
   .modal-header .btn-close {
      filter: brightness(0) invert(1);
      opacity: 0.8;
    }
    
    .modal-header .btn-close:hover {
      opacity: 1;
    }
    
    
    .modal-body {
      padding: 30px;
    }
    
    .modal-body.delete-modal-body {
      text-align: center;
      padding: 40px 30px;
    }
    
    .modal-body .icon-wrapper {
      width: 80px;
      height: 80px;
      margin: 0 auto 20px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .modal-body .icon-wrapper.delete-icon {
      background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
      color: white;
      box-shadow: 0 8px 20px rgba(220, 53, 69, 0.3);
    }
    /* Modal Footer Buttons */
.modal-footer {
  border-top: 1px solid #e9ecef;
  padding: 20px 30px;
  display: flex;
  justify-content: flex-end;
  gap: 12px;
}

/* Close button - Gray */
.btn-secondary {
  background: #6c757d !important;
  border: none;
  color: white;
  padding: 10px 24px;
  border-radius: 6px;
  font-weight: 500;
  font-size: 0.9rem;
  transition: all 0.2s ease;
  box-shadow: 0 2px 6px rgba(108, 117, 125, 0.25);
}

.btn-secondary:hover {
  background: #5a6268 !important;
  color: white !important;
  transform: translateY(-2px);
  box-shadow: 0 4px 10px rgba(108, 117, 125, 0.35);
}


    @media (max-width: 768px) {
     .btn-action-group {
        flex-direction: column;
        gap: 6px;
      }
      
      .btn-edit, .btn-danger-custom {
        width: 100%;
        font-size: 0.75rem;
        padding: 6px 12px;
      }
      
      
      .page-header {
        padding: 16px 20px;
      }
      
      .page-title {
        font-size: 1.4rem;
      }
    }

    .filter-section {
  background: white;
  padding: 24px;
  border-radius: 12px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.06);
  margin-bottom: 20px;
}

.filter-section label {
  font-weight: 500;
  color: #495057;
  margin-bottom: 8px;
  font-size: 0.875rem;
}

.filter-section .form-control,
.filter-section .form-select {
  border: 1px solid #e0e0e0;
  border-radius: 8px;
  padding: 10px 14px;
  transition: all 0.3s ease;
  font-size: 0.875rem;
}

.filter-section .form-control:focus,
.filter-section .form-select:focus {
  border-color: var(--primary-blue);
  box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
  outline: none;
}

  </style>
</head>

<body>
  <div class="preloader">
    <div class="lds-ripple"><div class="lds-pos"></div><div class="lds-pos"></div></div>
  </div>

  <div id="main-wrapper" data-theme="light" data-layout="vertical" data-navbarbg="skin6"
       data-sidebartype="full" data-sidebar-position="fixed" data-header-position="fixed"
       data-boxed-layout="full">

    <!-- Topbar -->
    <header class="topbar" data-navbarbg="skin6">
      <nav class="navbar top-navbar navbar-expand-lg">
        <div class="navbar-header" data-logobg="skin6">
          <a class="nav-toggler d-block d-lg-none" href="javascript:void(0)">
            <i class="ti-menu ti-close"></i>
          </a>
          <div class="navbar-brand">
            <a href="{% url 'donation:back_index' %}">
              <img src="{% static 'Front/assets/images/logo_site.png' %}" alt="logo" class="img-fluid" style="width: 120px; margin-top: 30px;">
            </a>
          </div>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="navbar-nav float-end">
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="javascript:void(0)" data-bs-toggle="dropdown">
                <img src="{% static 'Back/src/assets/images/users/profile-pic.jpg' %}" alt="user" class="rounded-circle" width="40">
                <span class="ms-2 d-none d-lg-inline-block">
                  <span class="text-dark">{{ user.first_name|default:"Admin" }}</span>
                  <i data-feather="chevron-down" class="svg-icon"></i>
                </span>
              </a>
              <div class="dropdown-menu dropdown-menu-end">
                <a class="dropdown-item" href="#">
                  <i data-feather="power" class="svg-icon me-2"></i>Logout
                </a>
              </div>
            </li>
          </ul>
        </div>
      </nav>
    </header>

    <!-- Sidebar -->
    <!-- Sidebar -->
    <aside class="left-sidebar" data-sidebarbg="skin6">
  <div class="scroll-sidebar" data-sidebarbg="skin6">
    <nav class="sidebar-nav">
      <ul id="sidebarnav">
        

        <li class="list-divider"></li>

        <!-- USER MANAGEMENT -->
        <li class="nav-small-cap"><span class="hide-menu">USER MANAGEMENT</span></li>
        <li class="sidebar-item">
          <a class="sidebar-link" href="{% url 'dashboard' %}">
            <i data-feather="users" class="feather-icon"></i>
            <span class="hide-menu">Users Management</span>
          </a>
        </li>

        <li class="list-divider"></li>
        <li class="nav-small-cap"><span class="hide-menu">PATIENT</span></li>
        <li class="sidebar-item">
            <a class="sidebar-link" href="{% url 'dashboard_home' %}" aria-expanded="false">
            <i data-feather="home" class="feather-icon"></i>
            <span class="hide-menu">Patient Dashboard</span>
            </a>
        </li>
        <li class="sidebar-item">
            <a class="sidebar-link" href="{% url 'appointment_list' %}">
            <i data-feather="calendar" class="feather-icon"></i>
            <span class="hide-menu">Appointments List</span>
            </a>
        </li>
        <li class="sidebar-item">
            <a class="sidebar-link" href="{% url 'patient_list' %}">
            <i data-feather="users" class="feather-icon"></i>
            <span class="hide-menu">Patients List</span>
            </a>
        </li>
        <li class="sidebar-item">
            <a class="sidebar-link" href="{% url 'appointment_create' %}">
            <i data-feather="plus-circle" class="feather-icon"></i>
            <span class="hide-menu">New Appointment</span>
            </a>
        </li>
         <li class="list-divider"></li>
        <!-- PRODUCTS -->
        <li class="nav-small-cap"><span class="hide-menu">PRODUCTS</span></li>
        <li class="sidebar-item">
          <a class="sidebar-link" href="{% url 'dashboard_products' %}">
            <i data-feather="home" class="feather-icon"></i>
            <span class="hide-menu">Product Dashboard</span>
          </a>
        </li>
        <li class="sidebar-item">
          <a class="sidebar-link" href="{% url 'products_list' %}">
            <i data-feather="package" class="feather-icon"></i>
            <span class="hide-menu">Products List</span>
          </a>
        </li>
        <li class="sidebar-item">
          <a class="sidebar-link" href="{% url 'orders_list' %}">
            <i data-feather="shopping-cart" class="feather-icon"></i>
            <span class="hide-menu">Orders List</span>
          </a>
        </li>

        <li class="list-divider"></li>


        <!-- DONATIONS -->
        <li class="nav-small-cap"><span class="hide-menu">DONATIONS</span></li>

        <li class="sidebar-item">
          <a class="sidebar-link" href="{% url 'donation:back_index' %}">
            <i data-feather="activity" class="feather-icon"></i>
            <span class="hide-menu">Dashboard Donation</span>
          </a>
        </li>
        <li class="sidebar-item">
          <a class="sidebar-link" href="{% url 'publication:publication_list' %}">
            <i data-feather="file-text" class="feather-icon"></i>
            <span class="hide-menu">Publications List</span>
          </a>
        </li>
         <li class="sidebar-item">
          <a class="sidebar-link" href="{% url 'publication:publication_form' %}">
            <i data-feather="plus-circle" class="feather-icon"></i>
            <span class="hide-menu">New Publication</span>
          </a>
        </li>
        <li class="sidebar-item">
          <a class="sidebar-link" href="{% url 'donation:admin_donation_list' %}">
            <i data-feather="heart" class="feather-icon"></i>
            <span class="hide-menu">Donations List</span>
          </a>
        </li>

        <li class="list-divider"></li>

        <li class="nav-small-cap"><span class="hide-menu">LABO</span></li>
        <li class="sidebar-item">
            <a class="sidebar-link" href="{% url 'Labapp:back_analyse_list' %}" aria-expanded="false">
            <i data-feather="calendar" class="feather-icon"></i>
            <span class="hide-menu">List Analyses</span>
            </a>
        </li>
        <li class="sidebar-item">
            <a class="sidebar-link" href="{% url 'Labapp:back_recherche_list' %}">
            <i data-feather="tag" class="feather-icon"></i>
            <span class="hide-menu">recherche List</span>
            </a>
        </li>

        <li class="list-divider"></li>
        
         <li class="nav-small-cap"><span class="hide-menu">STAGE</span></li>
        <li class="sidebar-item">
  <a class="sidebar-link" href="{% url 'stages:liste_stages' %}">
    <i data-feather="award" class="feather-icon"></i>
    <span class="hide-menu">Stages List</span>
  </a>
</li>

        <li class="sidebar-item">
  <a class="sidebar-link" href="{% url 'stages:ajouter_stage' %}">
    <i data-feather="award" class="feather-icon"></i>
    <span class="hide-menu">New Stage</span>
  </a>
</li>
<li class="sidebar-item">
  <a class="sidebar-link" href="{% url 'stagiaire:liste_stagiaires' %}">
    <i data-feather="user-check" class="feather-icon"></i>
    <span class="hide-menu">Stagiaires List</span>
  </a>
</li>

        
      </ul>
    </nav>
  </div>
</aside>

    <!-- Page wrapper -->
    <div class="page-wrapper">
      <div class="container-fluid">
        <!-- Page Header -->
        <div class="page-header">
          <div class="d-flex align-items-center justify-content-between">
            <h2 class="page-title">All Donations</h2>
            <!-- BUTTON EXPORT PDF -->
    <a href="{% url 'donation:export_donations_pdf' %}" class="btn btn-sm btn-danger" style="padding: 10px 20px; font-weight: 600; border-radius: 8px;" title="Export all orders to PDF">
                            <i data-feather="file-text"></i> Export PDF
                        </a>
          </div>
        </div>
<!-- Filter Section -->
<div class="filter-section">
  <form method="get" action="{% url 'donation:admin_donation_list' %}" id="filterForm" class="row g-3 align-items-end">

    <!-- SEARCH -->
    <div class="col-md-5">
      <label for="search" class="form-label">Search by Donor</label>
      <input type="text" 
             class="form-control" 
             id="search" 
             name="search" 
             placeholder="Enter donor name..." 
             value="{{ request.GET.search }}">
    </div>

    <!-- SORT -->
    <div class="col-md-3">
      <label for="sort" class="form-label">Sort By</label>
      <select class="form-select" id="sort" name="sort">
        <option value="">Latest First</option>
        <option value="date_asc"  {% if request.GET.sort == 'date_asc' %}selected{% endif %}>Date: Oldest First</option>
        <option value="date_desc" {% if request.GET.sort == 'date_desc' %}selected{% endif %}>Date: Newest First</option>
        <option value="amount_asc" {% if request.GET.sort == 'amount_asc' %}selected{% endif %}>Amount: Lowest First</option>
        <option value="amount_desc" {% if request.GET.sort == 'amount_desc' %}selected{% endif %}>Amount: Highest First</option>
      </select>
    </div>

    <!-- DATE FILTER -->
    <div class="col-md-3">
      <label for="date" class="form-label">Filter by Date</label>
      <input type="date" 
             class="form-control" 
             id="date" 
             name="date" 
             value="{{ request.GET.date }}">
    </div>

  </form>
</div>


        

        <!-- Table Card -->
        <div class="card">
          <div class="card-body">
            <div class="table-responsive">
              <table class="table">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Donor</th>
                    <th>Publication</th>
                    <th>Type</th>
                    <th>Amount</th>
                    <th>Description</th>
                    <th>Date</th>
                    <th>Status</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
  {% for donation in donations %}
  <tr data-bs-toggle="modal" data-bs-target="#donationDetailModal{{ donation.id_donation }}">
    <td>{{ donation.id_donation }}</td>
    <td>
      <div style="font-weight: 600;">
        {% if donation.id_user.first_name or donation.id_user.last_name %}
    {{ donation.id_user.first_name }} {{ donation.id_user.last_name }}
{% else %}
    {{ donation.id_user.email }}
{% endif %}


      </div>
      <div class="text-muted" style="font-size: 0.8rem;">
        {{ donation.id_user.email }}
      </div>
    </td>
    <td>
      <div style="font-weight: 500;">{{ donation.id_publication.title }}</div>
    </td>
    <td>
      {% if donation.type_donation == 'argent' %}
        <span class="badge-type badge-argent">üí∞ Money</span>
      {% else %}
        <span class="badge-type badge-volontariat">ü§ù Volunteer</span>
      {% endif %}
    </td>
    
    <!-- Colonne Amount - Null si volontariat -->
    <td>
      {% if donation.type_donation == 'argent' %}
        <strong style="color: #28a745; font-size: 1rem;">{{ donation.montant }} DT</strong>
        <div class="text-muted" style="font-size: 0.75rem;">
          {{ donation.get_methode_paiement_display }}
        </div>
      {% else %}
        <span class="text-muted" style="font-style: italic;">‚Äî</span>
      {% endif %}
    </td>
    
    <!-- Colonne Description - Null si argent -->
    <td>
      {% if donation.type_donation == 'volontariat' %}
        <div style="font-size: 0.8rem; color: #495057;">
          {{ donation.description|truncatewords:8 }}
        </div>
      {% else %}
        <span class="text-muted" style="font-style: italic;">‚Äî</span>
      {% endif %}
    </td>
    
    <td>{{ donation.date_donation|date:"Y-m-d H:i" }}</td>
    <td>
      {% if donation.statut == 'en_attente' %}
        <span class="badge-status badge-en-attente">
          <i data-feather="clock" style="width: 14px; height: 14px; margin-right: 4px; vertical-align: middle;"></i>
          Pending
        </span>
      {% elif donation.statut == 'valide' %}
        <span class="badge-status badge-valide">
          <i data-feather="check-circle" style="width: 14px; height: 14px; margin-right: 4px; vertical-align: middle;"></i>
          Approved
        </span>
      {% else %}
        <span class="badge-status badge-echec">
          <i data-feather="x-circle" style="width: 14px; height: 14px; margin-right: 4px; vertical-align: middle;"></i>
          Rejected
        </span>
      {% endif %}
    </td>
    <td onclick="event.stopPropagation();">
      <div class="btn-action-group">
        <!-- Detail button -->
        <button type="button"
                class="btn btn-detail"
                data-bs-toggle="modal"
                data-bs-target="#donationDetailModal{{ donation.id_donation }}"
                onclick="event.stopPropagation();">
          <i data-feather="eye"></i>
          <span>Detail</span>
        </button>

        <!-- Delete button -->
        <button type="button"
                class="btn btn-danger-custom"
                data-bs-toggle="modal"
                data-bs-target="#deleteDonationModal{{ donation.id_donation }}"
                onclick="event.stopPropagation();">
          <i data-feather="trash-2"></i>
          <span>Delete</span>
        </button>
      </div>
    </td>
  </tr>
  {% empty %}
  <tr>
    <td colspan="9" class="text-center text-muted py-5">
      <i data-feather="inbox" style="width: 48px; height: 48px; opacity: 0.5;"></i>
      <p class="mb-0 mt-3">No donations found</p>
    </td>
  </tr>
  {% endfor %}
</tbody>

              </table>
              {% if is_paginated %}
<nav aria-label="Page navigation example" class="mt-4 d-flex justify-content-center">
    <ul class="pagination">

        {% if page_obj.has_previous %}
        <li class="page-item">
            <a class="page-link"
               href="?page={{ page_obj.previous_page_number }}&{{ querystring }}">
                Previous
            </a>
        </li>
        {% endif %}

        {% for i in paginator.page_range %}
        <li class="page-item {% if page_obj.number == i %} active {% endif %}">
            <a class="page-link"
               href="?page={{ i }}&{{ querystring }}">
                {{ i }}
            </a>
        </li>
        {% endfor %}

        {% if page_obj.has_next %}
        <li class="page-item">
            <a class="page-link"
               href="?page={{ page_obj.next_page_number }}&{{ querystring }}">
                Next
            </a>
        </li>
        {% endif %}

    </ul>
</nav>

{% endif %}

            </div>
          </div>
        </div>
      </div>

      <footer class="footer text-center text-muted mt-4">
        Clinica+ Back ‚Ä¢ Freedash UI
      </footer>
    </div>
  </div>

  <!-- Donation Detail Modals -->
  {% for donation in donations %}
  <div class="modal fade" id="donationDetailModal{{ donation.id_donation }}" tabindex="-1">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">üíù Donation Details</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-md-6 mb-3">
              <strong>Donor:</strong>
              <p>{% if donation.id_user.first_name or donation.id_user.last_name %}
    {{ donation.id_user.first_name }} {{ donation.id_user.last_name }}
{% else %}
    {{ donation.id_user.email }}
{% endif %}

</p>
            </div>
            <div class="col-md-6 mb-3">
              <strong>Email:</strong>
              <p>{{ donation.id_user.email }}</p>
            </div>
            <div class="col-12 mb-3">
              <strong>Publication:</strong>
              <p style="font-weight: 600; color: #4A90E2;">
                {{ donation.id_publication.title }}
              </p>
            </div>
            <div class="col-md-6 mb-3">
              <strong>Type:</strong>
              <p>
                {% if donation.type_donation == 'argent' %}
                  <span class="badge-type badge-argent">üí∞ Money</span>
                {% else %}
                  <span class="badge-type badge-volontariat">ü§ù Volunteer</span>
                {% endif %}
              </p>
            </div>
            <div class="col-md-6 mb-3">
              <strong>Status:</strong>
              <p>
                {% if donation.statut == 'en_attente' %}
                  <span class="badge-status badge-en-attente">‚è≥ Pending</span>
                {% elif donation.statut == 'valide' %}
                  <span class="badge-status badge-valide">‚úÖ Approved</span>
                {% else %}
                  <span class="badge-status badge-echec">‚ùå Rejected</span>
                {% endif %}
              </p>
            </div>

            {% if donation.type_donation == 'argent' %}
              <div class="col-md-6 mb-3">
                <strong>Amount:</strong>
                <p style="font-size: 1.5rem; font-weight: 700; color: #28a745;">
                  {{ donation.montant }} DT
                </p>
              </div>
              <div class="col-md-6 mb-3">
                <strong>Payment Method:</strong>
                <p>{{ donation.get_methode_paiement_display }}</p>
              </div>
            {% else %}
              <div class="col-12 mb-3">
                <strong>Description:</strong>
                <p style="line-height: 1.8; color: #666;">
                  {{ donation.description|linebreaks }}
                </p>
              </div>
            {% endif %}

            <div class="col-12 mb-3">
              <strong>Date Created:</strong>
              <p>{{ donation.date_donation|date:"F d, Y H:i" }}</p>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          
        </div>
      </div>
    </div>
  </div>
  {% endfor %}

  <!-- Delete confirmation modals (separate, like publication_list) -->
  {% for donation in donations %}
  <div class="modal fade" id="deleteDonationModal{{ donation.id_donation }}" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header delete-header">
          <h5 class="modal-title">
            <i data-feather="alert-triangle" style="width: 20px; height: 20px; margin-right: 8px;"></i>
            Delete Donation
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body delete-modal-body">
          <div class="icon-wrapper delete-icon">
            <i data-feather="trash-2" style="width: 40px; height: 40px;"></i>
          </div>
          <h4 class="mb-3">Are you sure you want to delete this donation?</h4>
          <div class="mb-3">
            <p class="text-muted mb-2">
              <strong>Donor:</strong> {% if donation.id_user.first_name or donation.id_user.last_name %}
    {{ donation.id_user.first_name }} {{ donation.id_user.last_name }}
{% else %}
    {{ donation.id_user.email }}
{% endif %}

<br>
              <strong>Publication:</strong> {{ donation.id_publication.title }}<br>
              <strong>Type:</strong> {{ donation.get_type_donation_display }}<br>
              {% if donation.type_donation == 'argent' %}
                <strong>Amount:</strong> {{ donation.montant }} DT
              {% endif %}
            </p>
          </div>
          <p class="text-danger small mt-3">
            <i data-feather="alert-circle" style="width: 16px; height: 16px; vertical-align: middle;"></i>
            This action cannot be undone.
          </p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <form method="post" action="{% url 'donation:admin_donation_delete' donation.id_donation %}" style="display: inline;">
            {% csrf_token %}
            <button type="submit" class="btn btn-danger">
              <i data-feather="trash-2" style="width: 16px; height: 16px; margin-right: 5px;"></i>
              Delete
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>
  {% endfor %}

  <script src="{% static 'Back/src/assets/libs/jquery/dist/jquery.min.js' %}"></script>
  <script src="{% static 'Back/src/assets/libs/popper.js/dist/umd/popper.min.js' %}"></script>
  <script src="{% static 'Back/src/assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js' %}"></script>
  <script src="{% static 'Back/src/dist/js/feather.min.js' %}"></script>
  <script src="{% static 'Back/src/assets/libs/perfect-scrollbar/dist/perfect-scrollbar.jquery.min.js' %}"></script>
  <script src="{% static 'Back/src/dist/js/sidebarmenu.js' %}"></script>
  <script src="{% static 'Back/src/dist/js/custom.min.js' %}"></script>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      if (window.feather) feather.replace();
      
      var modals = document.querySelectorAll('.modal');
      modals.forEach(function(modal) {
        modal.addEventListener('shown.bs.modal', function() {
          if (window.feather) feather.replace();
        });
      });
    });
  </script>
  <script>
document.addEventListener('DOMContentLoaded', () => {

    const filterForm = document.getElementById('filterForm');

    // Auto-submit on sort or date change
    document.querySelectorAll('#sort, #date').forEach(input => {
        input.addEventListener('change', () => filterForm.submit());
    });

    // Auto-submit on search typing
    const search = document.getElementById('search');
    let timer;

    search.addEventListener('input', () => {
        clearTimeout(timer);
        timer = setTimeout(() => filterForm.submit(), 500);
    });

});
</script>

</script>

</body>

</html>